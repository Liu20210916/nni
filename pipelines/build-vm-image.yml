trigger: none
pr: none

jobs:
- job: windows
  pool:
    vmImage: windows-latest
  steps:
  - powershell: |
      cd test/vso_tools/build_vm
      $filePath = "windows.json"
      (Get-Content $filePath).Replace("<client_id>", "$(client_id)") | Set-Content $filePath
      (Get-Content $filePath).Replace("<client_secret>", "$(client_secret)") | Set-Content $filePath
      (Get-Content $filePath).Replace("<tenant_id>", "$(tenant_id)") | Set-Content $filePath
      (Get-Content $filePath).Replace("<subscription_id>", "$(subscription_id)") | Set-Content $filePath

      Get-Content $filePath
    displayName: Prepare packer configuration

  - powershell: |
      cd test/vso_tools/build_vm
      packer build windows.json
    displayName: Packer build
